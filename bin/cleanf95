#!/bin/sh
#  -*-Perl-*-
#======================================================================#
# Run the right perl version:
if [ -x /usr/local/bin/perl ]; then
  perl=/usr/local/bin/perl
elif [ -x /usr/bin/perl ]; then
  perl=/usr/bin/perl
else
  perl=`which perl| sed 's/.*aliased to *//'`
fi

exec $perl -x -S $0 "$@"     # -x: start from the following line
#======================================================================#
#! /Good_Path/perl -w 
# line 17

# Name:   cleanf95
# Author: Tony Mee (A.J.Mee@ncl.ac.uk)
# Date:   10-Oct-2002
# CVS: $Id: cleanf95,v 1.2 2002-10-10 12:01:06 dobler Exp $
# Description:
#   Read standard input (piped from Intel Fortran compiler with 2>&1 | 
#   i.e. from STDERR)
#   Strip all the subroutine / function lines and dump the rest back
#   out to STDERR
# Usage:
#   make |& cleanf95

my $identi = '[A-Z_0-9]+';  # valid F90 identifiers (as capitalized by compiler)
$| = 1;         # auto-flush output
while(<STDIN>)
{
  next if /^\s*(module|external)\s+(subroutine|function)\s+$identi\s*$/;
  next if /^\s*(program|module)\s+$identi\s*$/i;
  next if /^[0-9]+\s*lines compiled/i;
 
  print STDERR $_;    
}
