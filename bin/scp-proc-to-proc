#!/bin/csh
#$Id$
#
#  Purpose:
#      copies directory trees to another machine
#
#  Examples:
#     scp-proc-to-proc dim.dat $serv/f90/pencil-code/runs/forced/relax_twist128a
#     scp-proc-to-proc dim.dat $bar/pencil-code/runs/geodynamo/kws93/128f .
#     scp-proc-to-proc dim.dat . $dcsc/pencil-code/axel/MRIexp/128d
#     scp-proc-to-proc dim.dat . $dcsc/pencil-code/axel/couette/strat128a_mu0.30_g2

#  will copy all var.dat files fron current directory to var.dat in
#  another run directory.
#  Used for restarting in a different directory.
#  Added 4th argument for skipping over $skip counts

if ($#argv == 4) then
  set skip=$4
else
  set skip=0
endif

# set counter
set counter="1"

set procdirs  =  `ls data | grep proc `
foreach proc ($procdirs)
  if ( $counter >= $skip ) then
    echo "scp $3/data/$proc/$1 $2/data/$proc"
    nohup scp $3/data/$proc/$1 $2/data/$proc &
    sleep 1
  endif
  set counter = `expr $counter + 1`
  echo "counter=$counter"
end
